<!doctype html><html lang=en><head><title>探讨 Git 版本控制系统的若干问题 - 2020 版</title>
<meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><meta name=google-site-verification content><meta content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=5" name=viewport><meta content="telephone=no" name=format-detection><meta name=description content><meta name=renderer content="webkit"><meta name=theme-color content="#ffffff"><script src=/js/toc.js></script><link type=text/css rel=stylesheet href=/vendor/css/bootstrap.min.css><link rel=stylesheet href=/scss/dark-mode.min.cb53f1bee2b8900cb4f082afbf00175d6618f281cf9a2fe8619e3b52d20b5721.css integrity="sha256-y1PxvuK4kAy08IKvvwAXXWYY8oHPmi/oYZ47UtILVyE=" media=screen><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Material+Icons"></head><body><div id=app><div class=single-column-drawer-container id=drawer v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }"><div class=drawer-content><div class=drawer-menu><a class="a-block drawer-menu-item active" href=/posts>归档
</a><a class="a-block drawer-menu-item false" href=/categories>分类
</a><a class="a-block drawer-menu-item false" href=/tags>标签
</a><a class="a-block drawer-menu-item false" href=/about>关于
</a><a class="a-block drawer-menu-item false" href=/index.xml>RSS Feed</a><div class=toc><div class=toc-content><center>- CATALOG -</center><ul><ul><li><a href=#%e5%89%8d%e8%a8%80 class=nav-前言>前言</a></li><li><a href=#git-flow-%e4%b8%8e-git-%e7%9a%84%e8%a1%a8%e4%b8%8e%e9%87%8c class=nav-git-flow-与-git-的表与里>Git Flow 与 Git 的表与里</a></li><li><a href=#git-%e7%9a%84%e9%94%99%e4%bb%98 class=nav-git-的错付>Git 的错付</a></li><ul><li><a href=#git-%e6%88%91%e4%b8%8d%e5%81%9a%e7%bd%91%e7%9b%98 class=nav-git-我不做网盘>Git: 我不做网盘</a></li><li><a href=#lfs-%e6%88%91%e4%b8%8d%e4%bc%9a%e5%8e%8b%e7%bc%a9 class=nav-lfs-我不会压缩>LFS: 我不会压缩</a></li><li><a href=#git-%e6%88%91%e5%b0%b1%e8%bf%99%e6%a0%b7%e4%ba%86 class=nav-git-我就这样了>Git: 我就这样了</a></li></ul><li><a href=#git-%e7%9a%84%e9%87%8d%e6%96%b0%e6%80%9d%e8%80%83 class=nav-git-的重新思考>Git 的重新思考</a></li><ul><li><a href=#%e5%af%b9%e8%b1%a1%e5%ad%98%e5%82%a8%e7%9a%84%e9%87%8d%e6%96%b0%e6%80%9d%e8%80%83 class=nav-对象存储的重新思考>对象存储的重新思考</a></li><li><a href=#%e5%93%88%e5%b8%8c%e7%ae%97%e6%b3%95%e7%9a%84%e9%80%89%e6%8b%a9 class=nav-哈希算法的选择>哈希算法的选择</a></li><li><a href=#%e7%89%88%e6%9c%ac%e6%8e%a7%e5%88%b6%e7%b3%bb%e7%bb%9f%e7%9a%84%e4%b8%8b%e4%b8%80%e6%ad%a5 class=nav-版本控制系统的下一步>版本控制系统的下一步</a></li></ul><li><a href=#%e6%9c%80%e5%90%8e class=nav-最后>最后</a></li></ul></div></div></div></div></div><transition name=fade><div id=drawer-mask v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if=isDrawerOpen v-on:click=toggleDrawer></div></transition><nav id=navBar class="navbar sticky-top navbar-light single-column-nav-container"><div id=navBackground class=nav-background></div><div class="container container-narrow nav-content"><button id=nav_dropdown_btn class=nav-dropdown-toggle type=button v-on:click=toggleDrawer>
<i class=material-icons>menu
</i></button>
<a id=navTitle class=navbar-brand href=https://forcemz.net/>江二十三的思考
</a><button type=button class=nav-darkmode-toggle id=darkModeToggleButton2>
<i class=material-icons id=darkModeToggleIcon2>dark_mode</i></button></div></nav><div class=single-column-header-container id=pageHead v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }"><a href=https://forcemz.net/><div class=single-column-header-title>江二十三的思考</div><div class=single-column-header-subtitle>Themed by Diary.</div></a></div><div id=content><div id=streamContainer class=stream-container><div class="post-list-container post-list-container-shadow"><div class=post><div class=post-head-wrapper-text-only><div class=post-title>探讨 Git 版本控制系统的若干问题 - 2020 版<div class=post-meta><time itemprop=datePublished>2020-08-16 20:00
</time><i class=material-icons>folder</i>
<a href=/categories/git>git</a>
&nbsp;</div></div></div><div class=post-body-wrapper><div class=post-body v-pre><h2 id=前言>前言</h2><p>自 2014 年大学毕业以来，我一直从事代码托管相关工作，工作的内容和 git 相关，期间积累了很多心得体会，这大概是一般的 git 使用者很少会感知到的，一直以来，我也想将这些见解分享给大家，之前我写过《探讨 Git 代码托管平台的若干问题 - 2019 版》，这篇文章主要偏向代码托管平台的开发，与普通开发者存在一定的距离，快一年过去了，我又有了新的体会，写一篇关于 Git 版本控制系统的若干问题也就有了动机。</p><h2 id=git-flow-与-git-的表与里>Git Flow 与 Git 的表与里</h2><p>在使用 Git 进行团队协作的时候，网络上铺天盖地的推荐方案是使用 Git Flow 工作流，什么是 <code>Git Flow</code>？Git Flow 由 Vincent Driessen 在 2010 年，在文章 <a href=https://nvie.com/posts/a-successful-git-branching-model/>A successful Git branching model</a> 中提出，Atlassian 也写了一篇文章：<a href=https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow>Gitflow Workflow</a> 对其有个介绍，大致流程图如下：</p><p><img src=https://s1.ax1x.com/2020/08/16/dES0SA.png alt></p><p>简而言之，就是在 <code>develop</code> 分支快速迭代，将 <code>master</code> 作为稳定分支，使用 <code>feature</code> 分支添加新的功能。说实话，我并不是很喜欢 Gitflow，Git 的分支和 SVN 这样的版本控制系统相比，足够轻量，比如 SVN 新建分支需要拷贝分支，而 git 就是创建对某个 commit 的引用即可，这样看来，git 中的分支都是均权的，Gitflow 的概念就像话术了，比如我们完全可以把稳定分支命名未 <code>stable</code> 或者 <code>release</code>，把快速迭代分支命名为 <code>trunk</code>。实际上有一些开发者明确反对 Git Flow，比如 George Stocker 就写过 <a href=https://georgestocker.com/2020/03/04/please-stop-recommending-git-flow/>Please stop recommending Git Flow!</a>，而 Vincent Driessen 本人在今年也认为 Git flow 是一种教条。</p><div class=highlight><pre tabindex=0 style=color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>Note of reflection (March 5, 2020)
</span></span><span style=display:flex><span>This model was conceived in 2010, now more than 10 years ago, and not very long after Git itself came into being. In those 10 years, git-flow (the branching model laid out in this article) has become hugely popular in many a software team to the point where people have started treating it like a standard of sorts — but unfortunately also as a dogma or panacea.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>During those 10 years, Git itself has taken the world by a storm, and the most popular type of software that is being developed with Git is shifting more towards web apps — at least in my filter bubble. Web apps are typically continuously delivered, not rolled back, and you don&#39;t have to support multiple versions of the software running in the wild.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>This is not the class of software that I had in mind when I wrote the blog post 10 years ago. If your team is doing continuous delivery of software, I would suggest to adopt a much simpler workflow (like GitHub flow) instead of trying to shoehorn git-flow into your team.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>If, however, you are building software that is explicitly versioned, or if you need to support multiple versions of your software in the wild, then git-flow may still be as good of a fit to your team as it has been to people in the last 10 years. In that case, please read on.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>To conclude, always remember that panaceas don&#39;t exist. Consider your own context. Don&#39;t be hating. Decide for yourself.
</span></span></code></pre></div><p>在 git 的世界中，我们理解了分支和最终纳入版本控制的文件是如何组织的，就能更好的思考应该使用什么样的工作流。Git 的存储结构太多文章和文档有过说明，这里详述繁琐且没必要，简单的说一下，在 <code>refs</code> 目录或者 <code>packed-refs</code> 存储了 git 存储库的引用信息，引用名（<code>refs/heads/master</code>）与特定的 commit ID 映射，引用只有唯一的 commit ID，commit ID 却可以跟多个引用关联，比如我们使用 <code>git checkout -b</code> 或者 <code>git switch -c</code> 就可以基于当前的分支的 commit 创建新的分支。分支是包含特定前缀 <code>refs/heads/</code> 的引用。</p><p>Git commit 是 git 对象的顶层数据，在 git 对象中，包含 <code>commit</code>，<code>tree</code>，<code>blob</code> 这样的对象，一个 commit 有一个 tree，零个或者多个 parent commit，我们可以使用特定的命令查看 commit 的内容：</p><div class=highlight><pre tabindex=0 style=color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#828b96;font-style:italic># https://github.com/BLAKE3-team/BLAKE3.git</span>
</span></span><span style=display:flex><span>git cat-file -p 107f5c089f356334ee4abaeeca8c31704661f37d
</span></span></code></pre></div><p>其内容可能如下</p><div class=highlight><pre tabindex=0 style=color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>tree 107f5c089f356334ee4abaeeca8c31704661f37d
</span></span><span style=display:flex><span>parent f2005678f84a8222be69c54c3d5457c6c40e87d2
</span></span><span style=display:flex><span>author Jack O&#39;Connor &lt;jack.oconnor@zoom.us&gt; 1593462857 -0400
</span></span><span style=display:flex><span>committer Jack O&#39;Connor &lt;jack.oconnor@zoom.us&gt; 1593463133 -0400
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>stop being a jerk and add the context string to test_vectors.json
</span></span></code></pre></div><p>Git tree 对象存储了存储库的目录结构，tree 的格式为特殊的二进制格式，我们同样可以用 <code>git cat-file</code> 查看 tree 对象。</p><div class=highlight><pre tabindex=0 style=color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git cat-file -p 107f5c089f356334ee4abaeeca8c31704661f37d
</span></span></code></pre></div><p>tree 对象的 <code>pretty</code> 输出如下：</p><div class=highlight><pre tabindex=0 style=color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>040000 tree c44c5f00bbfd67a6e5597292b811055fa5f90034    .github
</span></span><span style=display:flex><span>100644 blob fa8d85ac52f19959d6fc9942c265708b4b3c2b04    .gitignore
</span></span><span style=display:flex><span>100644 blob 3a605f255e8cfd344c202bef8fe1645fd49a2095    CONTRIBUTING.md
</span></span><span style=display:flex><span>100644 blob 720e9a4ab4976211fe78ea44681150460cf9ed81    Cargo.toml
</span></span><span style=display:flex><span>100644 blob f5892efc3b9bac4beeb60e554e85f32e8692599e    LICENSE
</span></span><span style=display:flex><span>100644 blob c9f8bd517d5e8da7b178cf15804ea46ddb9e35c9    README.md
</span></span><span style=display:flex><span>040000 tree 6391f865df6b772571669f0193cfa84eb4a0ad40    b3sum
</span></span><span style=display:flex><span>040000 tree 278f91232f481d861dfda22ca6825a39bc3dd41c    benches
</span></span><span style=display:flex><span>100644 blob 38fc722db514b11c3febff8c9aad887b6b62c86d    build.rs
</span></span><span style=display:flex><span>040000 tree aa2ca2f0ab338bdf2effa1ad2333f09f70025a94    c
</span></span><span style=display:flex><span>040000 tree d0d0767a68d9cc36a2f27c390a07b974216e8ddc    media
</span></span><span style=display:flex><span>040000 tree e6826f60f7ad5377a8d05313db87c743174757af    reference_impl
</span></span><span style=display:flex><span>040000 tree 9118932371d77760db085bfc7341b41128486eb1    src
</span></span><span style=display:flex><span>040000 tree 13786a8e749207634046e73490725bcfc2714ca9    test_vectors
</span></span><span style=display:flex><span>040000 tree ade669b07438519f8133e02a575ffac3cf588250    tools
</span></span></code></pre></div><p>在 git 中 blob 存储的就是文件本身，其格式为 <code>type SPACE OCT_LENGTH NUL $FILE_CONTENT</code>，存储在磁盘的内容是使用 Deflate 压缩的，文件名在压缩前由 SHA1 计算文件头和文件内容得来，也就是说使用 Deflate 解压缩后，使用 SHA1 就可以获得与之匹配的 Blob ID，我们可以通过 <code>git cat-file</code> 查看文件内容</p><div class=highlight><pre tabindex=0 style=color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git cat-file -p fa8d85ac52f19959d6fc9942c265708b4b3c2b04
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>Cargo.lock
</span></span><span style=display:flex><span>target
</span></span></code></pre></div><p><img src=https://s1.ax1x.com/2020/08/16/dEOQc6.png alt></p><p>这里分享一个基于 Golang 编写的 Blob 细节查看演示程序（<a href=https://gist.github.com/fcharlie/2dde5a491d08dbc45c866cb370b9fa07>Gist</a>）：</p><div class=highlight><pre tabindex=0 style=color:#1d2432;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#ff636f>package</span> <span style=color:#58a1dd>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff636f>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#a6be9d>&#34;compress/zlib&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6be9d>&#34;crypto/sha1&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6be9d>&#34;encoding/hex&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6be9d>&#34;errors&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6be9d>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6be9d>&#34;hash&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6be9d>&#34;io&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6be9d>&#34;os&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6be9d>&#34;strconv&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#828b96;font-style:italic>// git blob view
</span></span></span><span style=display:flex><span><span style=color:#828b96;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#828b96;font-style:italic>// BlobViewer todo
</span></span></span><span style=display:flex><span><span style=color:#828b96;font-style:italic></span><span style=color:#ff636f>type</span> <span style=color:#58a1dd>BlobViewer</span> <span style=color:#ff636f>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>w</span>  <span style=color:#58a1dd>io</span>.<span style=color:#58a1dd>Writer</span>
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>zr</span> <span style=color:#58a1dd>io</span>.<span style=color:#58a1dd>ReadCloser</span>
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>fd</span> <span style=color:#ff636f>*</span><span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>File</span>
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>h</span>  <span style=color:#58a1dd>hash</span>.<span style=color:#58a1dd>Hash</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#828b96;font-style:italic>// NewBlobViewer new blob viewer
</span></span></span><span style=display:flex><span><span style=color:#828b96;font-style:italic></span><span style=color:#ff636f>func</span> <span style=color:#58a1dd>NewBlobViewer</span>(<span style=color:#58a1dd>p</span> <span style=color:#ff636f>string</span>, <span style=color:#58a1dd>w</span> <span style=color:#58a1dd>io</span>.<span style=color:#58a1dd>Writer</span>) (<span style=color:#ff636f>*</span><span style=color:#58a1dd>BlobViewer</span>, <span style=color:#ff636f>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>fd</span>, <span style=color:#58a1dd>err</span> <span style=color:#ff636f>:=</span> <span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Open</span>(<span style=color:#58a1dd>p</span>)
</span></span><span style=display:flex><span>	<span style=color:#ff636f>if</span> <span style=color:#58a1dd>err</span> <span style=color:#ff636f>!=</span> <span style=color:#ff636f>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#ff636f>return</span> <span style=color:#ff636f>nil</span>, <span style=color:#58a1dd>err</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#ff636f>return</span> <span style=color:#ff636f>&amp;</span><span style=color:#58a1dd>BlobViewer</span>{<span style=color:#58a1dd>fd</span>: <span style=color:#58a1dd>fd</span>, <span style=color:#58a1dd>w</span>: <span style=color:#58a1dd>w</span>, <span style=color:#58a1dd>h</span>: <span style=color:#58a1dd>sha1</span>.<span style=color:#58a1dd>New</span>()}, <span style=color:#ff636f>nil</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff636f>func</span> (<span style=color:#58a1dd>bv</span> <span style=color:#ff636f>*</span><span style=color:#58a1dd>BlobViewer</span>) <span style=color:#58a1dd>readUntil</span>(<span style=color:#58a1dd>delim</span> <span style=color:#ff636f>byte</span>) ([]<span style=color:#ff636f>byte</span>, <span style=color:#ff636f>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#ff636f>var</span> <span style=color:#58a1dd>buf</span> [<span style=color:#a6be9d>1</span>]<span style=color:#ff636f>byte</span>
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>value</span> <span style=color:#ff636f>:=</span> <span style=color:#58a1dd>make</span>([]<span style=color:#ff636f>byte</span>, <span style=color:#a6be9d>0</span>, <span style=color:#a6be9d>16</span>)
</span></span><span style=display:flex><span>	<span style=color:#ff636f>for</span> {
</span></span><span style=display:flex><span>		<span style=color:#ff636f>if</span> <span style=color:#58a1dd>n</span>, <span style=color:#58a1dd>err</span> <span style=color:#ff636f>:=</span> <span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>zr</span>.<span style=color:#58a1dd>Read</span>(<span style=color:#58a1dd>buf</span>[:]); <span style=color:#58a1dd>err</span> <span style=color:#ff636f>!=</span> <span style=color:#ff636f>nil</span> <span style=color:#ff636f>&amp;&amp;</span> (<span style=color:#58a1dd>err</span> <span style=color:#ff636f>!=</span> <span style=color:#58a1dd>io</span>.<span style=color:#58a1dd>EOF</span> <span style=color:#ff636f>||</span> <span style=color:#58a1dd>n</span> <span style=color:#ff636f>==</span> <span style=color:#a6be9d>0</span>) {
</span></span><span style=display:flex><span>			<span style=color:#ff636f>if</span> <span style=color:#58a1dd>err</span> <span style=color:#ff636f>==</span> <span style=color:#58a1dd>io</span>.<span style=color:#58a1dd>EOF</span> {
</span></span><span style=display:flex><span>				<span style=color:#ff636f>return</span> <span style=color:#ff636f>nil</span>, <span style=color:#58a1dd>errors</span>.<span style=color:#58a1dd>New</span>(<span style=color:#a6be9d>&#34;invalid header&#34;</span>)
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			<span style=color:#ff636f>return</span> <span style=color:#ff636f>nil</span>, <span style=color:#58a1dd>err</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>h</span>.<span style=color:#58a1dd>Write</span>(<span style=color:#58a1dd>buf</span>[:])
</span></span><span style=display:flex><span>		<span style=color:#ff636f>if</span> <span style=color:#58a1dd>buf</span>[<span style=color:#a6be9d>0</span>] <span style=color:#ff636f>==</span> <span style=color:#58a1dd>delim</span> {
</span></span><span style=display:flex><span>			<span style=color:#ff636f>return</span> <span style=color:#58a1dd>value</span>, <span style=color:#ff636f>nil</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#58a1dd>value</span> = <span style=color:#58a1dd>append</span>(<span style=color:#58a1dd>value</span>, <span style=color:#58a1dd>buf</span>[<span style=color:#a6be9d>0</span>])
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#828b96;font-style:italic>// Header Lookup header
</span></span></span><span style=display:flex><span><span style=color:#828b96;font-style:italic></span><span style=color:#ff636f>func</span> (<span style=color:#58a1dd>bv</span> <span style=color:#ff636f>*</span><span style=color:#58a1dd>BlobViewer</span>) <span style=color:#58a1dd>Header</span>() <span style=color:#ff636f>error</span> {
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>raw</span>, <span style=color:#58a1dd>err</span> <span style=color:#ff636f>:=</span> <span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>readUntil</span>(<span style=color:#a6be9d>&#39; &#39;</span>)
</span></span><span style=display:flex><span>	<span style=color:#ff636f>if</span> <span style=color:#58a1dd>err</span> <span style=color:#ff636f>!=</span> <span style=color:#ff636f>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#ff636f>return</span> <span style=color:#58a1dd>err</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>fmt</span>.<span style=color:#58a1dd>Fprintf</span>(<span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Stderr</span>, <span style=color:#a6be9d>&#34;object type is: \x1b[34m%s\x1b[0m\n&#34;</span>, <span style=color:#58a1dd>raw</span>)
</span></span><span style=display:flex><span>	<span style=color:#ff636f>if</span> <span style=color:#58a1dd>raw</span>, <span style=color:#58a1dd>err</span> = <span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>readUntil</span>(<span style=color:#a6be9d>0</span>); <span style=color:#58a1dd>err</span> <span style=color:#ff636f>!=</span> <span style=color:#ff636f>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#ff636f>return</span> <span style=color:#58a1dd>err</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>size</span>, <span style=color:#58a1dd>err</span> <span style=color:#ff636f>:=</span> <span style=color:#58a1dd>strconv</span>.<span style=color:#58a1dd>ParseInt</span>(<span style=color:#58a1dd>string</span>(<span style=color:#58a1dd>raw</span>), <span style=color:#a6be9d>10</span>, <span style=color:#a6be9d>64</span>)
</span></span><span style=display:flex><span>	<span style=color:#ff636f>if</span> <span style=color:#58a1dd>err</span> <span style=color:#ff636f>!=</span> <span style=color:#ff636f>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#ff636f>return</span> <span style=color:#58a1dd>err</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>fmt</span>.<span style=color:#58a1dd>Fprintf</span>(<span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Stderr</span>, <span style=color:#a6be9d>&#34;object size: \x1b[34m%d\x1b[0m\n&#34;</span>, <span style=color:#58a1dd>size</span>)
</span></span><span style=display:flex><span>	<span style=color:#ff636f>return</span> <span style=color:#ff636f>nil</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#828b96;font-style:italic>//Lookup blob details
</span></span></span><span style=display:flex><span><span style=color:#828b96;font-style:italic></span><span style=color:#ff636f>func</span> (<span style=color:#58a1dd>bv</span> <span style=color:#ff636f>*</span><span style=color:#58a1dd>BlobViewer</span>) <span style=color:#58a1dd>Lookup</span>() <span style=color:#ff636f>error</span> {
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>zr</span>, <span style=color:#58a1dd>err</span> <span style=color:#ff636f>:=</span> <span style=color:#58a1dd>zlib</span>.<span style=color:#58a1dd>NewReader</span>(<span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>fd</span>)
</span></span><span style=display:flex><span>	<span style=color:#ff636f>if</span> <span style=color:#58a1dd>err</span> <span style=color:#ff636f>!=</span> <span style=color:#ff636f>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#ff636f>return</span> <span style=color:#58a1dd>err</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>zr</span> = <span style=color:#58a1dd>zr</span>
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>Header</span>()
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>mw</span> <span style=color:#ff636f>:=</span> <span style=color:#58a1dd>io</span>.<span style=color:#58a1dd>MultiWriter</span>(<span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>w</span>, <span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>h</span>)
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>_</span>, <span style=color:#58a1dd>_</span> = <span style=color:#58a1dd>io</span>.<span style=color:#58a1dd>Copy</span>(<span style=color:#58a1dd>mw</span>, <span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>zr</span>)
</span></span><span style=display:flex><span>	<span style=color:#ff636f>return</span> <span style=color:#ff636f>nil</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#828b96;font-style:italic>// Close close blob viewer
</span></span></span><span style=display:flex><span><span style=color:#828b96;font-style:italic></span><span style=color:#ff636f>func</span> (<span style=color:#58a1dd>bv</span> <span style=color:#ff636f>*</span><span style=color:#58a1dd>BlobViewer</span>) <span style=color:#58a1dd>Close</span>() <span style=color:#ff636f>error</span> {
</span></span><span style=display:flex><span>	<span style=color:#ff636f>if</span> <span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>zr</span> <span style=color:#ff636f>!=</span> <span style=color:#ff636f>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>zr</span>.<span style=color:#58a1dd>Close</span>()
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>fmt</span>.<span style=color:#58a1dd>Fprintf</span>(<span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Stderr</span>, <span style=color:#a6be9d>&#34;Hash: %s\n&#34;</span>, <span style=color:#58a1dd>hex</span>.<span style=color:#58a1dd>EncodeToString</span>(<span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>h</span>.<span style=color:#58a1dd>Sum</span>(<span style=color:#ff636f>nil</span>)))
</span></span><span style=display:flex><span>	<span style=color:#ff636f>if</span> <span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>fd</span> <span style=color:#ff636f>!=</span> <span style=color:#ff636f>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#ff636f>return</span> <span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>fd</span>.<span style=color:#58a1dd>Close</span>()
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#ff636f>return</span> <span style=color:#ff636f>nil</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff636f>func</span> <span style=color:#58a1dd>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#ff636f>if</span> <span style=color:#58a1dd>len</span>(<span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Args</span>) &lt; <span style=color:#a6be9d>2</span> {
</span></span><span style=display:flex><span>		<span style=color:#58a1dd>fmt</span>.<span style=color:#58a1dd>Fprintf</span>(<span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Stderr</span>, <span style=color:#a6be9d>&#34;usage: %s blob-id\n&#34;</span>, <span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Args</span>[<span style=color:#a6be9d>0</span>])
</span></span><span style=display:flex><span>		<span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Exit</span>(<span style=color:#a6be9d>1</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#58a1dd>bv</span>, <span style=color:#58a1dd>err</span> <span style=color:#ff636f>:=</span> <span style=color:#58a1dd>NewBlobViewer</span>(<span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Args</span>[<span style=color:#a6be9d>1</span>], <span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Stdout</span>)
</span></span><span style=display:flex><span>	<span style=color:#ff636f>if</span> <span style=color:#58a1dd>err</span> <span style=color:#ff636f>!=</span> <span style=color:#ff636f>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#58a1dd>fmt</span>.<span style=color:#58a1dd>Fprintf</span>(<span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Stderr</span>, <span style=color:#a6be9d>&#34;open: %s error %v\n&#34;</span>, <span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Args</span>[<span style=color:#a6be9d>1</span>], <span style=color:#58a1dd>err</span>)
</span></span><span style=display:flex><span>		<span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Exit</span>(<span style=color:#a6be9d>1</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#ff636f>defer</span> <span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>Close</span>()
</span></span><span style=display:flex><span>	<span style=color:#ff636f>if</span> <span style=color:#58a1dd>err</span> <span style=color:#ff636f>:=</span> <span style=color:#58a1dd>bv</span>.<span style=color:#58a1dd>Lookup</span>(); <span style=color:#58a1dd>err</span> <span style=color:#ff636f>!=</span> <span style=color:#ff636f>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#58a1dd>fmt</span>.<span style=color:#58a1dd>Fprintf</span>(<span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Stderr</span>, <span style=color:#a6be9d>&#34;lookup: %s error %v\n&#34;</span>, <span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Args</span>[<span style=color:#a6be9d>1</span>], <span style=color:#58a1dd>err</span>)
</span></span><span style=display:flex><span>		<span style=color:#58a1dd>os</span>.<span style=color:#58a1dd>Exit</span>(<span style=color:#a6be9d>1</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>git 的内里还是十分简单的，无论分支名怎样变，内部的组织结构并没有显著差别，是一种简单的轻量的分支形式，因此，我们在选择 Git Workflow 时，或许应该解放思想，实事求是，遵循自己的业务模型。</p><p>像操作系统，比如 Windows，Linux 内核，FreeBSD，以及 LLVM，GCC 这样的大型软件，需要定期发布新版本，然后给新版本执行一个生命周期，开发流程类似于 <code>Trunk-Release-Tag</code> 在 Git 语义下，我们认为是 <code>Master-Release-Tag</code>，即在主干分支上不断演进，定期从主干创建特定的 Release 分支，然后 Release 不添加新的功能，只修复 BUG，按照发布路线图和实际测试情况发布新的 Release (也就是 Tag)。一般的大型软件均会采取这种演进模型。</p><p>对于 Web 服务而言，类似 Git Flow 的模型确实是合适的选择，快速演进能够及时修复问题和增加新的功能，但如果服务不仅仅提供给公有云用户，那么还是需要考虑到版本化，Git Flow 不是灵丹妙药，需要开发者按照实际需求来。</p><h2 id=git-的错付>Git 的错付</h2><p>git 是个优秀的版本控制系统也避免不了用户的不恰当使用，最后反而导致用户体验的下降。如果 Git 是个人，估计会大声说 “臣妾做不到啊”，这就是 Git 的错付了。</p><h3 id=git-我不做网盘>Git: 我不做网盘</h3><p>作为代码托管的业内人士，我遇到过非常多的使用 Git 当网盘，存储二进制，做图床的场景，这种使用经常给平台带来了很高的 QPS，也会可能导致用户的存储库超出体积限制。要解释这个问题，我们要理解 Git 是基于文件快照的，当使用 git 将文件纳入版本控制时，git 实际上将文件内容原样合成 blob 压缩后存储，此时，比如我们使用 git 管理一个 50MB 大小的文件，那么，修改 20 次后，如果按照 50% 的压缩率，那么，光这个文件的历史记录累计的体积也就达到了 500MB，这非常可观。</p><p>Git 存储文件会被压缩，如果做图床，不做优化的情况下，每次下载图片时，都需要解压 Blob，这实际上会给平台带来性能问题，消耗掉计算资源。另外，图片格式通常是一种压缩格式，按照香农信息论，特定的字节数所承载的信息是有上限的，也就是说，文件是不能被无限压缩的，因此，Git 存储被压缩的文件实际上效果并不明显，反而浪费 CPU。为了避免图床的场景影响平台的负载，大多数 Git 代码托管平台都会使用 <code>RAW</code> 缓存，以避免这类请求拖累系统。当网盘和图床场景类似。</p><h3 id=lfs-我不会压缩>LFS: 我不会压缩</h3><p>为了解决大文件存储问题，Github 推出了 Git LFS 管理 Git 大文件，避免大文件频繁更改导致存储库体积过度膨胀。但 Git LFS 并不是万能灵药，一些不合适的使用场景可能会导致反常的预期。</p><p>比如我最近接触到一个场景下，有开发者使用 Git LFS 管理 JDK8 二进制，将大多数 Java 命令和 Jar 等文件使用 LFS 追踪，如果完全使用 Git 管理，存储库的体积是 175MB，这就意味着下载的数据量为 175MB。但 Git LFS 并不会压缩文件，下载数据时，使用 HTTP GET 请求依次下载，我们查看 <code>lfs/objects</code> 目录的文件大小为 366MB，而查看 LFS 文件数量，大致是 199 个，那么，需要发送的 HTTP 请求为 199 次，这种场景下，势必会导致 LFS 服务器 QPS 过高，用户下载数据缓慢。</p><p>回过头来看，Git LFS 的使用是有边界的，只要在特定的条件下，才具备相应的优势，否则会降低用户体验，造成客户端和服务端的双输。</p><h3 id=git-我就这样了>Git: 我就这样了</h3><p>Git 虽然强大，但有一些功能也是不容易做到，比如完整的目录权限控制，尽管我们告诉私有化客户，可以做到目录级别权限控制，但那仅仅只能做到写入控制，而无法做到读取控制。另外 Git 还不能真正的做到类似 SVN 一样的部分检出，尽管目前增加了部分克隆功能，但在协议上，仍然做不到 SVN 那种层度。</p><p>作为一个代码托管平台开发者，有时候需要和用户解释为什么不那么做也挺累的。</p><h2 id=git-的重新思考>Git 的重新思考</h2><p>Git 虽然强大，但并不完美，比如哈希算法选择的是不安全的 SHA1，压缩算法选择的是 Deflate，如果创建个新的版本控制系统确实可以好好思考了。</p><h3 id=对象存储的重新思考>对象存储的重新思考</h3><p>Git 存储文件的对象叫做 Blob，Blob 格式的设计比较简单，格式如下图上侧，Type 的类型用户标识是 Blob 还是 Commit 还是 Tree。数据按图所示拼接计算出哈希值后，将哈希值作为对象的 ID，然后使用 Deflate 压缩，这种机制并不是很完美的，比如不能按原样存储，文件不能无限压缩，因此，git 并不适合存储压缩文件，二进制文件。</p><p>今年以来，我曾参与 minizip，libzip，archiver 的 ZIP 格式对 Zstd 压缩算法的支持，了解到 ZIP 中的 Store 存储机制，ZIP 可以将其他 ZIP 文件按照 Store 的方式原样存储到新的 ZIP 文件中，这无疑可以避免重复的压缩文件，浪费 CPU。因此，理想中的 Git 对象存储变成了下图下侧，文件的哈希不包含文件的长度，类型和压缩算法，仅与文件的原始内容相关。</p><p><img src=https://s1.ax1x.com/2020/08/16/dVwjE9.png alt></p><p>Git 选择的 Deflate 并不是一个优异的压缩算法，无论是压缩率还是压缩速度都不是最佳的，如果在重新设计 Git 的时候，Zstd 应该是一个更好的选择。下表是 Zstd 与 Zlib(Deflate) 压缩比和速度的一个对比。</p><table><thead><tr><th>Compressor name</th><th>Ratio</th><th>Compression</th><th>Decompress.</th></tr></thead><tbody><tr><td><strong>zstd 1.4.5 -1</strong></td><td>2.884</td><td>500 MB/s</td><td>1660 MB/s</td></tr><tr><td>zlib 1.2.11 -1</td><td>2.743</td><td>90 MB/s</td><td>400 MB/s</td></tr><tr><td>brotli 1.0.7 -0</td><td>2.703</td><td>400 MB/s</td><td>450 MB/s</td></tr><tr><td><strong>zstd 1.4.5 &ndash;fast=1</strong></td><td>2.434</td><td>570 MB/s</td><td>2200 MB/s</td></tr><tr><td><strong>zstd 1.4.5 &ndash;fast=3</strong></td><td>2.312</td><td>640 MB/s</td><td>2300 MB/s</td></tr><tr><td>quicklz 1.5.0 -1</td><td>2.238</td><td>560 MB/s</td><td>710 MB/s</td></tr><tr><td><strong>zstd 1.4.5 &ndash;fast=5</strong></td><td>2.178</td><td>700 MB/s</td><td>2420 MB/s</td></tr><tr><td>lzo1x 2.10 -1</td><td>2.106</td><td>690 MB/s</td><td>820 MB/s</td></tr><tr><td>lz4 1.9.2</td><td>2.101</td><td>740 MB/s</td><td>4530 MB/s</td></tr><tr><td><strong>zstd 1.4.5 &ndash;fast=7</strong></td><td>2.096</td><td>750 MB/s</td><td>2480 MB/s</td></tr><tr><td>lzf 3.6 -1</td><td>2.077</td><td>410 MB/s</td><td>860 MB/s</td></tr><tr><td>snappy 1.1.8</td><td>2.073</td><td>560 MB/s</td><td>1790 MB/s</td></tr></tbody></table><p>下图是压缩解压的对比（来源于 <a href=https://github.com/facebook/zstd>Zstandard</a>）：</p><table><thead><tr><th>Compression Speed vs Ratio</th><th>Decompression Speed</th></tr></thead><tbody><tr><td><img src=https://s1.ax1x.com/2020/08/16/dVpadK.png alt="Compression Speed vs Ratio" title="Compression Speed vs Ratio"></td><td><img src=https://s1.ax1x.com/2020/08/16/dVp0iD.png alt="Decompression Speed" title="Decompression Speed"></td></tr></tbody></table><h3 id=哈希算法的选择>哈希算法的选择</h3><p>自从 SHA1 被破解以来，Git 选择新的哈希算法便提上了日程，经过多次讨论，Git 开发者最终选择了不是最佳的 SHA256。SHA256 是最佳选择吗？不见得，我写过一个 Kisasum 的压缩工具，比较了 SHA256，BLAKE3，KangarooTwelve，SHA3，SM3 等压缩算法，SHA256 的速度位于下游，BLAKE3 官方有个测评，如下：</p><p><img src=https://s1.ax1x.com/2020/08/16/dVPRdx.png alt></p><p>使用 <code>Measure-Command</code> 命令测评 SHA256 和 BLAKE3 计算 224MB 的 <code>sarasa-gothic-ttf-0.12.14.7z</code> ，实测速度差距如下：</p><p><img src=https://s1.ax1x.com/2020/08/16/dVFM8S.png alt></p><p>SHA256 耗费了 1884ms，BLAKE3 耗费了 331ms，差距已经有 5 倍了，而且这里 Kisasum 的 BLAKE3 没有使用多线程，差距还可能更大。如果让我选择哈希算法，我可能选择 BLAKE3 或者 KangarooTwelve。</p><h3 id=版本控制系统的下一步>版本控制系统的下一步</h3><p>优秀的版本控制系统是 DevOps 生态中重要的一环，除了提供版本控制的功能之外，还要有利于 DevOps 功能整合，下图是我对版本控制系统下一步增强的期许，而现实情况下，Git 实现下面的功能比较复杂，并不是那么方便，从业人员也经常不得不曲线救国。</p><p><img src=https://s1.ax1x.com/2020/08/16/dVE8DH.png alt></p><h2 id=最后>最后</h2><p>Git 已经诞生十五年了，Git 的取代者是谁？</p><hr width=100% id=EOF><p style=color:#777>Last modified on 2020-08-16</p></div></div><nav class=post-pagination><a class=newer-posts href=/posts/2020/2020-12-25-performance-scalability-and-high-availability-for-git/>Next<br>性能，可扩展性和高可用 - 大型 Git 代码托管平台的关键问题
</a><a class=older-posts href=/posts/2020/2020-07-18-baulk/>Previous<br>Baulk - 开发一个简单的包管理工具历程</a></nav><div class=post-comment-wrapper></div></div></div></div></div><div id=sideContainer class=side-container><a class="a-block nav-head false" href=https://forcemz.net/><div class=nav-title>江二十三的思考</div><div class=nav-subtitle>Themed by Diary.</div></a><div class=nav-link-list><a class="a-block nav-link-item active" href=/posts>归档
</a><a class="a-block nav-link-item false" href=/categories>分类
</a><a class="a-block nav-link-item false" href=/tags>标签
</a><a class="a-block nav-link-item false" href=/about>关于
</a><a class="a-block nav-link-item false" href=/index.xml>RSS Feed</a></div><div class=nav-footer>Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>Ported from <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
Copyright (c) 2009-2024 J23</div></div><div id=extraContainer class=extra-container><div class=toc-wrapper><div class=toc><div class=toc-content><center>- CATALOG -</center><ul><ul><li><a href=#%e5%89%8d%e8%a8%80 class=nav-前言>前言</a></li><li><a href=#git-flow-%e4%b8%8e-git-%e7%9a%84%e8%a1%a8%e4%b8%8e%e9%87%8c class=nav-git-flow-与-git-的表与里>Git Flow 与 Git 的表与里</a></li><li><a href=#git-%e7%9a%84%e9%94%99%e4%bb%98 class=nav-git-的错付>Git 的错付</a></li><ul><li><a href=#git-%e6%88%91%e4%b8%8d%e5%81%9a%e7%bd%91%e7%9b%98 class=nav-git-我不做网盘>Git: 我不做网盘</a></li><li><a href=#lfs-%e6%88%91%e4%b8%8d%e4%bc%9a%e5%8e%8b%e7%bc%a9 class=nav-lfs-我不会压缩>LFS: 我不会压缩</a></li><li><a href=#git-%e6%88%91%e5%b0%b1%e8%bf%99%e6%a0%b7%e4%ba%86 class=nav-git-我就这样了>Git: 我就这样了</a></li></ul><li><a href=#git-%e7%9a%84%e9%87%8d%e6%96%b0%e6%80%9d%e8%80%83 class=nav-git-的重新思考>Git 的重新思考</a></li><ul><li><a href=#%e5%af%b9%e8%b1%a1%e5%ad%98%e5%82%a8%e7%9a%84%e9%87%8d%e6%96%b0%e6%80%9d%e8%80%83 class=nav-对象存储的重新思考>对象存储的重新思考</a></li><li><a href=#%e5%93%88%e5%b8%8c%e7%ae%97%e6%b3%95%e7%9a%84%e9%80%89%e6%8b%a9 class=nav-哈希算法的选择>哈希算法的选择</a></li><li><a href=#%e7%89%88%e6%9c%ac%e6%8e%a7%e5%88%b6%e7%b3%bb%e7%bb%9f%e7%9a%84%e4%b8%8b%e4%b8%80%e6%ad%a5 class=nav-版本控制系统的下一步>版本控制系统的下一步</a></li></ul><li><a href=#%e6%9c%80%e5%90%8e class=nav-最后>最后</a></li></ul></div></div></div><div class=pagination><a id=globalBackToTop class="pagination-action animated-visibility" href=#top :class="{ invisible: scrollY == 0 }"><i class="material-icons pagination-action-icon">keyboard_arrow_up
</i></a><a type=button class=pagination-action id=darkModeToggleButton><span class="material-icons pagination-action-icon" id=darkModeToggleIcon>dark_mode</span></a></div></div><div id=single-column-footer>Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>Ported from <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
Copyright (c) 2009-2024 J23</div></div><script src=/js/journal.js></script></body></html>