<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.140.0"><title>江二十三的思考</title>
<meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><meta name=google-site-verification content><meta content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=5" name=viewport><meta content="telephone=no" name=format-detection><meta name=description content><meta name=renderer content="webkit"><meta name=theme-color content="#ffffff"><link type=text/css rel=stylesheet href=/vendor/css/bootstrap.min.css><link rel=stylesheet href=/scss/dark-mode.min.cb53f1bee2b8900cb4f082afbf00175d6618f281cf9a2fe8619e3b52d20b5721.css integrity="sha256-y1PxvuK4kAy08IKvvwAXXWYY8oHPmi/oYZ47UtILVyE=" media=screen><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Material+Icons"></head><body><div id=app><div class=single-column-drawer-container id=drawer v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }"><div class=drawer-content><div class=drawer-menu><a class="a-block drawer-menu-item false" href=/posts>归档
</a><a class="a-block drawer-menu-item false" href=/categories>分类
</a><a class="a-block drawer-menu-item false" href=/tags>标签
</a><a class="a-block drawer-menu-item false" href=/about>关于
</a><a class="a-block drawer-menu-item false" href=/index.xml>RSS Feed</a></div></div></div><transition name=fade><div id=drawer-mask v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if=isDrawerOpen v-on:click=toggleDrawer></div></transition><nav id=navBar class="navbar sticky-top navbar-light single-column-nav-container"><div id=navBackground class=nav-background></div><div class="container container-narrow nav-content"><button id=nav_dropdown_btn class=nav-dropdown-toggle type=button v-on:click=toggleDrawer>
<i class=material-icons>menu
</i></button>
<a id=navTitle class=navbar-brand href=https://forcemz.net/>江二十三的思考
</a><button type=button class=nav-darkmode-toggle id=darkModeToggleButton2>
<i class=material-icons id=darkModeToggleIcon2>dark_mode</i></button></div></nav><div class=single-column-header-container id=pageHead v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }"><a href=https://forcemz.net/><div class=single-column-header-title>江二十三的思考</div><div class=single-column-header-subtitle>Themed by Diary.</div></a></div><div id=content><div id=streamContainer class=stream-container><div class="post-list-container post-list-container-no-background"><a href=/posts/2020/2020-07-18-baulk/ class=a-block><div class=post-item-wrapper><div class="post-item post-item-no-divider"><div class=post-item-info-wrapper><div class=post-item-title>Baulk - 开发一个简单的包管理工具历程</div><div class=post-item-summary><h2 id=前言>前言</h2><p>相对于其他操作系统，我更习惯使用 Windows，但一直以来 Windows 缺乏官方的包管理器，而第三方无论是 Scoop 还是 Chocolatey 都无法满足我独特的需求，我的要求很简单，所有的软件包都应该使用绿色解压模式，这包括了 MSI 安装包，另外安装软件时不应该修改系统和用户环境变量。包管理工具应该足够快，还要支持创建启动器等等。</p></div><div class=post-item-meta>2020-07-18
&emsp;
&emsp;</div></div></div></div><a href=/posts/2020/2020-06-30-nonsense-file-compression/ class=a-block><div class=post-item-wrapper><div class="post-item post-item-no-divider"><div class=post-item-info-wrapper><div class=post-item-title>胡说八道文件压缩</div><div class=post-item-summary><h1 id=前言>前言</h1><p>在我们日常使用计算机的时候，经常会遇到或者使用一些文件，它们通常以 <code>.zip</code>，<code>.rar</code>，<code>.7z</code> 结尾，这些文件就是本文所说的压缩文件，我们可以通过资源管理器，WinRAR，WinZip，或者 7-zip 将其解压，然后查看，编辑，或者进行其他操作。压缩软件被广泛运用于文件分享，软件分发，或作为一个容器承载其他文件集合，比如我们如果使用 Office 2007 以及更高的版本保存 Word/PPT/Excel 文档时，这些文档实际上就是特殊的 ZIP 压缩文件，Word/PPT/Excel 的格式实际上就是将描述元素（文本框，标题&mldr;） 信息的 XML 文件，以及一些资源文件使用 Deflate(Fastest) 压缩算法压缩到一个 ZIP 格式文件中。还有 Java 程序员需要经常见到的 Jar 包，Android 开发者打包的 APK 文件，以及 Windows 开发者创建的 Appx(以及 MSIX) 安装包，这些文件都是压缩文件，准确的说，这几种都是 ZIP 压缩文件。</p></div><div class=post-item-meta>2020-06-30
&emsp;
&emsp;</div></div></div></div><a href=/posts/2020/2020-04-24-realpath/ class=a-block><div class=post-item-wrapper><div class="post-item post-item-no-divider"><div class=post-item-info-wrapper><div class=post-item-title>文件的真实路径</div><div class=post-item-summary><h1 id=前言>前言</h1><p>最近浏览 Windows Terminal 提交，发现其文档中链接了一个 PowerShell 的 Issue：<a href=https://github.com/PowerShell/PowerShell/issues/9970>Windows Store applications incorrectly assumed to be console applications </a>，这个问题描述起来很简单，就是在 PowerShell 中打开 <code>wt.exe</code>， PowerShell 会一直等待 Windows Terminal 的退出，但实际上 Windows Terminal 是一个 GUI 程序，按照 Windows 的默认行为，PowerShell 在创建 Windows Terminal 进程后，就应该返回。这个问题是怎么产生的，其实很简单，<code>wt.exe</code> 是 Windows Terminal 的 <code>AppExecutionAlias</code>，<code>AppExecutionAlias</code> 是一类特殊的重解析点，Windows 在创建进程时会根据 <code>AppExecutionAlias</code> 设施的信息启动对应的 Store App。那么 PowerShell 应当获得相应 Store App 的主程序的 <code>Subsystem</code> 才能正确的决定是否应该等待进程退出。因此这里获得其真实路径是必不可少的。</p></div><div class=post-item-meta>2020-04-24
&emsp;
&emsp;</div></div></div></div><a href=/posts/2020/2020-01-10-talking-about-eating-pork/ class=a-block><div class=post-item-wrapper><div class="post-item post-item-no-divider"><div class=post-item-info-wrapper><div class=post-item-title>谈吃肉</div><div class=post-item-summary><p>2019 年早已过去，这年下半年最显著的感受是肉价腾贵，11 月初，听闻凯哥来深出差，于周日邀请他来住所做饭吃。或是许久未吃过回锅肉，买菜的时候，凯哥特意要求称了一块价值 16 元的猪肉，单价 40 一斤。若做其它肉菜，本以为够哥俩吃一顿，但回锅肉却是需要分量的，那一顿吃的颇不尽兴。一周之后，在浪基住处又做了一次回锅肉，此时购买了两块共计四十块的猪肉，此次回锅肉依然没有吃尽兴，不过好在还有我带过去的腊牛肉，干豆角，小干鱼，以及主人家买的基围虾，秋葵，牛肉反而吃得尽兴。</p></div><div class=post-item-meta>2020-01-10
&emsp;
&emsp;</div></div></div></div><a href=/posts/2019/2019-10-01-explore-some-issues-with-git-host/ class=a-block><div class=post-item-wrapper><div class="post-item post-item-no-divider"><div class=post-item-info-wrapper><div class=post-item-title>探讨 Git 代码托管平台的若干问题 - 2019 版</div><div class=post-item-summary><h2 id=关于-git>关于 Git</h2><p>版本控制软件种类繁多，维基百科收录的最早的版本控制系统是 1972 年贝尔实验室开发的 <a href=https://en.wikipedia.org/wiki/Source_Code_Control_System>Source Code Control System</a>。1986 年 <a href=https://en.wikipedia.org/wiki/Concurrent_Versions_System>Concurrent Versions System(CVS)</a> 诞生，CVS 曾非常流行，但今时用之寥寥无几，不过 OpenBSD 仍在使用 CVS。2000 年 CollabNet 创建了 Subversion 项目，2009年，Subversion 被 Apache 基金会接受成为顶级项目并被命名为 <a href=https://en.wikipedia.org/wiki/Apache_Subversion>Apache Subversion</a>。2005 年 <a href=https://en.wikipedia.org/wiki/Git>Linus Torvalds</a> 创建了 Git，2007 Github 诞生后，Git 随着 Github 的发展愈发流行，14 年间，Git 成为了最流行的版本控制系统，无论是 Windows 还是 Linux 或是 Android，MySQL 等等大型软件都使用 git 进行版本控制。纵观版本控制系统流行史，前有 CVS 后有 SVN，今日 Git 更风流。俱往矣，数风流人物，还看今朝，版本控制系统莫不如斯。</p></div><div class=post-item-meta>2019-10-01
&emsp;
&emsp;</div></div></div></div><a href=/posts/2019/2019-08-07-implement-sudo-in-windows/ class=a-block><div class=post-item-wrapper><div class="post-item post-item-no-divider"><div class=post-item-info-wrapper><div class=post-item-title>在 Windows 中实现 sudo</div><div class=post-item-summary><h1 id=前言>前言</h1><p><em>这篇文章的想法来源于我在 <a href=https://github.com/microsoft/terminal/issues/146>Windows Terminal Issue#146</a> 的<a href=https://github.com/microsoft/terminal/issues/146#issuecomment-515812461>评论</a>。</em></p><p><a href=https://linux.die.net/man/8/sudo>sudo</a> 以另一个用户执行命令，通常是 <code>root</code>。当普通用户需要以其他权限执行某项工作时，通常需要获得指定用户的权限，以目标权限 <code>root</code> 为例，我们期望以 root 权限运行，可以使用 <code>su</code> 登录到 <code>root</code> 用户，在这种情况下，一直到退出 <code>root</code>。都使用的是 <code>root</code> 权限，这实际上并不是安全的，处于高级别权限的时间应当尽量的短。而使用 <code>sudo</code> 获得 root 权限要安全的多，这种情况下，只有特定的命令才会获得 root 权限，而不是整个用户和 shell. 话又说回来，sudo 是如何获得 root 权限的？在 Windows 中的 sudo 又是怎么一回事，如何在 Windows 中实现类似的 sudo.</p></div><div class=post-item-meta>2019-08-07
&emsp;
&emsp;</div></div></div></div><a href=/posts/2019/2019-07-30-gnk-server-side/ class=a-block><div class=post-item-wrapper><div class="post-item post-item-no-divider"><div class=post-item-info-wrapper><div class=post-item-title>服务端 Git 钩子的妙用</div><div class=post-item-summary><h1 id=背景>背景</h1><p>在 <a href=https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks>《Pro Git》</a> 的 <strong>Server-Side Hooks</strong> 介绍了三种钩子，分别是 <code>pre-receive</code> 已经 <code>update</code> 还有 <code>post-receive</code>。GITEE 最初是基于 Gitlab 发展而来，最开始在服务端使用的是 <code>update</code> 钩子。我们使用 <code>update</code> 钩子完成一些保护分支/只读分支的功能。随着 Gitee 的不断发展，也有人提出了一些新的服务需求，为了解决大仓库大文件，我们开发了 Git Native Hook (GNK)。新的钩子利用了 git 的一些新的特性，在不同的阶段实现不同的功能，这里就介绍一下这些钩子的妙用。</p></div><div class=post-item-meta>2019-07-30
&emsp;
&emsp;</div></div></div></div><a href=/posts/2019/2019-07-20-cmdline-escape/ class=a-block><div class=post-item-wrapper><div class="post-item post-item-no-divider"><div class=post-item-info-wrapper><div class=post-item-title>Windows 命令行转义杂谈</div><div class=post-item-summary><h2 id=背景>背景</h2><p>2019 年五月的 Microsoft Build 大会，微软宣布了 Windows Terminal，并在 Github 上开源：<a href=https://github.com/microsoft/terminal>https://github.com/microsoft/terminal</a>。我作为技术爱好者，肯定要尝鲜一番。</p><p>使用截图：</p><p><img src=https://user-images.githubusercontent.com/6904176/58634006-b05e6080-82d9-11e9-9e3f-2715647edf1b.png alt></p><p>在使用的过程中，多标签，亚克力的窗口背景和 <code>Colour Emojis</code> 都让我非常满意，而且使用 Direct2D 绘制的 emoji，看起来要比 Mintty 使用 GDI+PNG 的 emoji 方案好的多（PNG 的 emoji 无论是放大和缩小都更容易失真，Mintty 并没有 Segoe UI 字体的 emoji 风格，其他风格我并不太喜欢）。不过我在使用的过程中发现了一个 BUG，即 <a href=https://github.com/microsoft/terminal/issues/1090>Bug Report: The conhost command line is not properly escaped #1090 </a>，后来我又提交了一个 PR 修复了此问题，在研究其他软件源码时，我发现这个问题并不是个例，因此有必要对此问题进行一次讨论，便有了此文。</p></div><div class=post-item-meta>2019-07-20
&emsp;
&emsp;</div></div></div></div><a href=/posts/2019/2019-07-09-july-tech-sharing/ class=a-block><div class=post-item-wrapper><div class="post-item post-item-no-divider"><div class=post-item-info-wrapper><div class=post-item-title>七月的技术分享</div><div class=post-item-summary><h2 id=前言>前言</h2><p>写代码是一个不断积累的过程，将一些好的想法转变为解决实际问题的程序通常让程序员感到愉悦。而最近我也有两个还算好的想法，在本文中分享给大家。</p><h2 id=支持环境变量展开的配置解析>支持环境变量展开的配置解析</h2><p>在 Gitee 的基础服务组件中，像 Basalt (git ssh 服务器)，git-diamond (Gitee 内部的 git 协议服务器)，git-srv (Gitee 分布式 git 传输后端) 都支持这样形式的配置： <code>${APPDIR}/run/git-srv.pid</code> 。在运行过程中，<code>APPDIR</code> 被解释成相应组件的安装根目录，在配置文件中，解析到 <code>${APPDIR}/run/git-srv.pid</code> 后，使用推导函数，将其展开为 <code>/home/git/oscstudio/run/git-srv.pid</code>。这样一来，默认配置情况下，Gitee 的这些组件都支持安装到任意位置，而无需在编译时设置 <code>--prefix</code>。而像 nginx 这样的软件，在构建时，使用 <code>--prefix</code> 指定了安装目录后，如果不使用 <code>-p</code> 指定 <code>prefix</code>，是无法安装到任意位置的。</p></div><div class=post-item-meta>2019-07-09
&emsp;
&emsp;</div></div></div></div><a href=/posts/2019/2019-06-25-talk-computer-update/ class=a-block><div class=post-item-wrapper><div class="post-item post-item-no-divider"><div class=post-item-info-wrapper><div class=post-item-title>坐和放宽 - 您的计算机需要更新</div><div class=post-item-summary><h1 id=前言>前言</h1><p>今天在微博上看到了新浪科技的一篇微博，其主要内容如下：</p><blockquote><p>#创事记#【用不胜其烦的update，将Windows用户捆绑上未来战车】网友苦Windows久矣。众所周知，Windows Update是很烦人的更新，其中以win10的用户最为水深火热。目前看来，用户还需要在一次次漫长而琐碎的更新升级中等待，而时代的洪流终会蜿蜒地书写出微软的对与错。@脑极体Unity Windows不胜其烦的update</p></div><div class=post-item-meta>2019-06-25
&emsp;
&emsp;</div></div></div></div></a></div></div></div><div id=sideContainer class=side-container><a class="a-block nav-head active" href=https://forcemz.net/><div class=nav-title>江二十三的思考</div><div class=nav-subtitle>Themed by Diary.</div></a><div class=nav-link-list><a class="a-block nav-link-item false" href=/posts>归档
</a><a class="a-block nav-link-item false" href=/categories>分类
</a><a class="a-block nav-link-item false" href=/tags>标签
</a><a class="a-block nav-link-item false" href=/about>关于
</a><a class="a-block nav-link-item false" href=/index.xml>RSS Feed</a></div><div class=nav-footer>Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>Ported from <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
Copyright (c) 2009-2024 J23</div></div><div id=extraContainer class=extra-container><div class=toc-wrapper></div><div class=pagination><a id=globalBackToTop class="pagination-action animated-visibility" href=#top :class="{ invisible: scrollY == 0 }"><i class="material-icons pagination-action-icon">keyboard_arrow_up
</i></a><a type=button class=pagination-action id=darkModeToggleButton><span class="material-icons pagination-action-icon" id=darkModeToggleIcon>dark_mode
</span></a><a class=pagination-action href=/><i class="material-icons pagination-action-icon">chevron_left</i></a><div class=pagination-indicator><span style=text-align:center>2<br><div style=display:inline-block;transform:rotate(-28deg)>-</div><br>6</span></div><a class=pagination-action href=/page/3/><i class="material-icons pagination-action-icon">chevron_right</i></a></div></div><div class=pagination><a class=pagination-action href=/ style=opacity:1><i class="material-icons pagination-action-icon">chevron_left</i></a><div class=pagination-indicator><span>2/6</span></div><a class=pagination-action href=/page/3/ style=opacity:1><i class="material-icons pagination-action-icon">chevron_right</i></a></div><div id=single-column-footer>Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://risehere.net/>Rise</a><br>Ported from <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
Copyright (c) 2009-2024 J23</div></div><script src=/js/journal.js></script></body></html>